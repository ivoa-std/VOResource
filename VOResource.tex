\documentclass[11pt,a4paper]{ivoa}
\input tthdefs

\usepackage{listings}
\lstloadlanguages{XML}
\lstset{flexiblecolumns=true,tagstyle=\ttfamily, showstringspaces=False}

\title{VOResource: an XML Encoding Schema for Resource Metadata}

\ivoagroup{Registry}

\author[http://www.ivoa.net/twiki/bin/view/IVOA/RayPlante]{Raymond Plante}
\author[http://www.ivoa.net/twiki/bin/view/IVOA/KevinBenson]{Kevin Benson}
\author[http://www.ivoa.net/twiki/bin/view/IVOA/MarkusDemleitner]{Markus Demleitner}
\author[http://www.ivoa.net/twiki/bin/view/IVOA/MatthewGraham]{Matthew Graham}
\author[http://www.ivoa.net/twiki/bin/view/IVOA/GretchenGreene]{Gretchen Greene}
\author[http://www.ivoa.net/twiki/bin/view/IVOA/PaulHarrison]{Paul Harrison}
\author[http://www.ivoa.net/twiki/bin/view/IVOA/GerardLemson]{Gerard Lemson}
\author[http://www.ivoa.net/twiki/bin/view/IVOA/TonyLinde]{Tony Linde}
\author[http://www.ivoa.net/twiki/bin/view/IVOA/GuyRixon]{Guy Rixon}

\editor{Ray Plante, Markus Demleitner}

\previousversion[http://www.ivoa.net/Documents/REC/ReR/VOResource-20080222.html]{REC -1.03}
\previousversion[http://www.ivoa.net/Documents/WD/ReR/VOResource-20061107.html]
  {WD 2006-11-07}
\previousversion[http://www.ivoa.net/Documents/WD/ReR/VOResource-20060620.html]
  {WD 2006-06-20}
\previousversion[http://www.ivoa.net/Documents/WD/ReR/VOResource-20060530.html]
  {WD-2006-05-30}
      

\begin{document}
\begin{abstract}
This document describes an XML encoding standard for IVOA Resource
Metadata, referred to as VOResource.  This schema is primarily
intended to support interoperable registries used for discovering
resources; however, any application that needs to describe resources
may use this schema.  In this document, we define the types and
elements that make up the schema as representations of metadata terms
defined in Resource Metadata for the Virtual Observatory
\citep{2007ivoa.spec.0302H}.  We also describe the general model for the
schema and explain how it may be extended to add new metadata terms and
describe more specific types of resources.  
\end{abstract}


\section*{Acknowledgments}

This document has been developed with support from the
National Science Foundation's
Information Technology Research Program under Cooperative Agreement
AST0122449 with The Johns Hopkins University, from the
UK Particle Physics and Astronomy
Research Council (PPARC), and from the
Eurpean Commission's Sixth
Framework Program via the 
Optical Infrared Coordination Network (OPTICON).  Funding for the 2016
update was provided by BMBF grant GAVO-2014, grant number 05A14VHA.

\section*{Conformance-related definitions}

The words ``MUST'', ``SHALL'', ``SHOULD'', ``MAY'', ``RECOMMENDED'', and
``OPTIONAL'' (in upper or lower case) used in this document are to be
interpreted as described in IETF standard RFC2119 \citep{std:RFC2119}.

The \emph{Virtual Observatory (VO)} is a
general term for a collection of federated resources that can be used
to conduct astronomical research, education, and outreach.
The \href{http://www.ivoa.net}{International
Virtual Observatory Alliance (IVOA)} is a global
collaboration of separately funded projects to develop standards and
infrastructure that enable VO applications.

\section*{Syntax Notation Using XML Schema}

The eXtensible Markup Language, or XML, is document syntax for marking
textual information with named tags and is defined by \citet{std:XML}.
The set of XML tag names and the syntax
rules for their use is referred to as the document schema.  One way to
formally define a schema for XML documents is using the W3C standard
known as XML Schema \citep{std:XSD}.

This document defines the VOResource schema using XML Schema, the
authoritative version of which is available at the IVOA document
repository\footnote{\url{http://www.ivoa.net/xml}} at any time.
Parts of the schema appear within the main sections of this document;
however, documentation nodes have been left out for the sake of brevity,
and where their content diverges from the one in the document
repository, the one in the document repository is authoritative.

Reference to specific elements and types defined in the VOResource
schema include the namespaces prefix \xmlel{vr} as in
\xmlel{vr:Resource} (a type defined in the VOResource schema).
% TODO: stronger language discouraging non-vr prefixes.
Use of the \xmlel{vr} prefix in compliant instance documents is 
not required (see sect.~\ref{sect:namespace}); its use in this
document is simply to indicate that it is an entity defined in the
VOResource schema.

\section{Introduction}

The IVOA Standard Resource Metadata for the Virtual Observatory
\citep{2007ivoa.spec.0302H}, hereafter referred to as RM, defines
metadata terms for describing resources.  The RM defines a resource as: 

\begin{quotation}
\dots VO element that can be described in terms of who curates or
maintains it and which can be given a name and a unique identifier.
Just about anything can be a resource: it can be an abstract idea,
such as sky coverage or an instrumental setup, or it can be fairly
concrete, like an organization or a data collection.  This definition
is consistent with its use in the general Web community as
``anything that has an identity'' \citep{std:RFC2396}.  We
expand on this definition by saying that it is also describable.  
\end{quotation}

The resource metadata are, then, the terms and concepts that describe
a resource in general.  The RM defines the terms as well as describes
reasonable or allowed values; it does not, however, describe how the
terms and values should be encoded.  This is because resource metadata
may be encoded in several different formats, depending on the
context.  This document specifically describes an encoding called
VOResource.  

The primary intended use of VOResource is to provide an XML interchange
format for use with resource registries.  A registry is a repository of
resource descriptions and is employed by users and applications to
discover resources.  VOResource can be used to pass descriptions from
publishers to registries and then from registries to applications.
Another inended use is as a language for services to describe themselves
directly.  VOResource may be used in other ways, in whole or in part,
using the standard XML mechanisms (e.g., import, include).  

The VOResource schema provides XML encoding for so-called core
metadata from the RM that (with a few exceptions)
can apply to all resources; however, it is recognized that a full and
useful description of a \emph{specific} resource will require
additional metadata that is relevant only to a resource of its type.
Thus, the VOResource schema has been especially designed to be
extended.  The model for doing this is described in
sect.~\ref{sect:extending}.

\begin{admonition}{Note}
The name "VOResource" has in practice had two meanings within
IVOA discussions.  The first refers specifically to the core
XML schema defined by this document.  The second refers more
broadly to the core schema plus the set of legal extensions.
In this document, use of the name "VOResource" corresponds to
the first meaning.  Reference to the broader set of schemas
will be indicated explicitly with the annotating phrase, "and
its legal extensions."
\end{admonition}

\subsection{Role within the VO Architecture}

\begin{figure}
\centering

\includegraphics[width=0.9\textwidth]{archdiag.png}
\caption{Architecture diagram for this document}
\label{fig:archdiag}
\end{figure}

Fig.~\ref{fig:archdiag} shows the VOResource plays within the
IVOA architecture \citep{note:VOARCH}.



\section{The VOResource Data Model}
\label{sect:model}

The primary use for VOResource, of course, is to describe a resource
using the metadata concepts defined in the RM.  Here is an example of a
VOResource document describing an organisation, the Radio Astronomy
Imaging Group at the National Center for Supercomputing Applications.  

\begin{lstlisting}[language=XML,numbers=right,basicstyle=\footnotesize]
<?xml version="1.0" encoding="UTF-8"?>
<resource xsi:type="Organisation"
  xmlns:vr="http://www.ivoa.net/xml/VOResource/v1.0"
  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
  xsi:schemaLocation="http://www.ivoa.net/xml/VOResource/v1.0
                      http://www.ivoa.net/xml/VOResource/v1.0">

    <title>NCSA Radio Astronomy Imaging</title>
    <shortName>NCSA-RAI</shortName>
    <identifier>ivo://rai.ncsa/RAI</identifier>

    <curation>
      <publisher ivo-id="ivo://ncsa.uiuc/NCSA">
         National Center for Supercomputing Applications
      </publisher>
      <creator>
        <name>   Dr. Richard Crutcher    </name>
        <logo>
           http://rai.ncsa.uiuc.edu/rai.jpg
        </logo>
      </creator>
      <date>1993-01-01</date>
      <contact>
        <name>Dr. Raymond Plante</name>
      	<email>rplante@ncsa.uiuc.edu</email>
      </contact>
    </curation>

    <content>
      <subject>radio astronomy</subject>
      <subject>data repositories</subject>
      <subject>digital libraries</subject>
      <subject>grid-based processing</subject>
      <description>
        The Radio Astronomy Imaging Group at the National Center for
        Supercomputing Applications is focused on applying
        high-performance computing to astronomical research.  Our
        projects include the NCSA Astronomy Digital Image Library, 
        the BIMA Data Archive, the BIMA Image Pipeline, and the
        National Virtual Observatory. 
      </description>
      <referenceURL>http://rai.ncsa.uiuc.edu/</referenceURL>
      <type>Organisation</type>
      <contentLevel>Research</contentLevel>
    </content>

    <facility>Berkeley-Illinois-Maryland Array (BIMA)</facility>
    <facility>
       Combined Array for Research in Millimeter Astronomy (CARMA)
    </facility>

</resource>
\end{lstlisting}

This example illustrates some important components of a VOResource
record:

\begin{enumerate}
  \item the VOResource namespace (line 3),
  \item the specific type of resource indicated by
       the value of the \xmlel{xsi:type} attribute (line 2),
  \item the location of the schema documents used by
       this description (lines 5f),
  \item values for the three main types core metadata:
       identity, curation, and content,
  \item a reference to another resource is made by
       providing that resource's IVOA identifier (line 13),
  \item string values can be padded with spaces
       for easier readability (e.g., line 17),
  \item extension metadata specific to the type of
       resource (lines 47ff).
\end{enumerate}


\subsection{The Schema Namespace and Location}

\label{sect:namespace}


The VOResource schema namespace is "http://www.ivoa.net/xml/VOResource/v1.0".
The namespace URI has been chosen to allow it to be resolved as a URL
to the XML Schema document that defines the VOResource schema.
Applications may assume that the namespace URI is so resolvable.

Authors of instance documents that use the VOResource schema may choose
to provide a location for VOResource XML Schema document using the
\xmlel{xsi:schemaLocation} attribute; the choice of the location value
is the choice of the author.  In general, the use of
\xmlel{xsi:schemaLocation} is recommended by this specification with
a the namespace URI given as the location as illustrated in the example
above, unless the application prefers otherwise.


\begin{lstlisting}
xsi:schemaLocation="http://www.ivoa.net/xml/VOResource/v1.0
                    http://www.ivoa.net/xml/VOResource/v1.0"
\end{lstlisting}

% TODO: always require namespace declaration
Whenever instance validation is needed, use of
the VOResource schema and its legal extensions must be declared using
the standard namespace declaration attribute, 
\verb|xmlns:prefix| (where \verb|prefix| is an arbitrary
prefix).  The prefix \xmlel{vr} is used by convention as the
prefix defined for the VOResource schema; however, instance documents
may use any prefix of the author's choosing.  In this document, the
\xmlel{vr} prefix is used to label, as shorthand, a type or
element name that is defined in the VOResource schema, as in
\xmlel{vr:Resource}. 

Because the VOResource XML schema sets
\verb|elementFormDefault="unqualified"|, documents that use the
VOResource schema should not use the namespace declaration attribute
\xmlel{xmlns} (used to set the default namespace), anywhere in
the document where the VOResource schema is in effect.  (This is a
restriction set by the rules of XML Schema.)  Furthermore, in
accordance with the Schema rules for unqualified elements, the
VOResource namespace prefix must not used to qualify VOResource
elements.  In general, namespace prefixes are only used to qualify
type names given as values to the \xmlel{xsi:type} attribute (see
next section).  Legal extensions of the VOResource schema SHOULD also
set \verb|elementFormDefault="unqualified"| for consistancy.



\subsection{The Core Structural and Semantic Model}
\label{sect:core}

The VOResource schema only defines global types; it does not define
any global elements (often refered to as root elements).  It is the
responsibility of the application to define the root element of the
VOResource-employing documents it operates on.  Typically, the root
element is defined in a separate application-specific schema.  The
type of an application document's root element is not assumed to be
any particular type defined in the VOResource schema (nor any of its
legal extensions).  In fact, it need not be of a type from the
VOResource at all; rather, VOResource types may appear anywhere in the
document.   



\begin{admonition}{Note}
The IVOA Registry Interface standard, for example, includes a
small schema that defines a single global element,
\xmlel{VOResources}, that can contain a series of
\xmlel{resource} child elements.  The child
element is defined to be of the type \xmlel{Resource} from
the VOResource schema.
\end{admonition}

\begin{admonition}{Note}
In the example instance
document at the beginning of section~\ref{sect:model}, the root element,
\xmlel{resource} is not defined in any schema.
Nevertheless, this document is still legal and verifiable XML.
This is because the element's type is explicitly specified with
the \xmlel{xsi:type} attribute.
\end{admonition}


% TODO: subsection name convention?

VOResource uses the following conventions for
names of elements and types:

\begin{itemize}
  \item all global types it defines have names that are capitalized.
       (This practice would extend to global elements, if they existed
       in the VOResource.)   
  \item Locally defined elements begin with a lower-case character. 
  \item For all types and element names that are made up of multiple
       words, such as \xmlel{shortName}, upper-case letters are
       used demarcate the start of appended word (the "camel"
       format).  
  \item Names that include abbreviations, such as
       \xmlel{IdentifierURI}, all letters in the abbreviation are
       capitalized.  
\end{itemize}

It is recommended that this convention be followed in other schemas
that either use the VOResource schema (via an \xmlel{xsd:import} or
\xmlel{xsd:include}) or extend it.  

Applications describe a single resource using an element of the type
\xmlel{vr:Resource} or a legal derivation of it.  The content of the
\xmlel{vr:Resource} type is referred to as the \textbf{core VOResource
metadata}, and they fall into four categories (corresponding to the
sections 3.1, 3.2, 3.3, and 4 of the RM):

\begin{itemize}
  \item identity metadata:  the \xmlel{title},
       \xmlel{shortName}, and
       \xmlel{identifier} elements;
  \item curation metadata:  the contents of the
       \xmlel{curation} element;
  \item general content metadata:  the contents of the
       \xmlel{content} element;
  \item metadata quality flags:  the
       \xmlel{validationLevel} element.
\end{itemize}


These elements are defined in more detail in sect.~\ref{sect:metadata}.



Many of the elements in VOResource that are meant to have string or
URI values are defined as being of the type \xmlel{xs:token}.
This allows authors of VOResource instance documents to pad string and
URI values with spaces and include carriage returns to improve
readability.  The definition of these types will cause an XML
Schema-compliant parser to replace tab, line feed, and carraige return
characters with simple spaces, then replace multiple sequential
occurrences of spaces with a single space, and then remove all leading
and trailing spaces.  


% TODO: Actually specify time format
All VOResource elements and attributes that contain dates must be
interpreted as UTC dates and must be encoded in compliance with ISO8601
standard Date and Time Format.  The \xmlel{vr:UTCTimestamp} type
provides a special restriction of the format that requires includsion of
date and time, but disallows the timezone format.  This enforces a
restricted form of this format which allows encoding of the date and
time, but disallows the timezone format:

% GENERATED: !schemadoc VOResource-v1.0.xsd UTCTimestamp
% /GENERATED


The \xmlel{vr:UTCDateTime} type allows the date to appear either
as a simple date--i.e. conforming to \xmlel{xs:date}--or as a
date and time as restricted by \xmlel{vr:UTCTimestamp}.  
When either of these VOResource types is used, authors must provide an
applicable UTC date and time, and applications must interpret the time
and date as UTC. 

All VOResource types and elements have an associated semantic meaning
which is given in the first \xmlel{xsd:documentation}
node within the type or element's definition in the schema.  The
meaning associated with a type is generic, indicating the kind of
information the type provides.  The semantics that are delivered by a
VOResource instance document, however, are those associated with
VOResource elements.  The meaning of a VOResource element can be
thought of as having two parts:  the generic meaning of the set of
information it contains as defined by its type, and a specific meaning
describing the context in which that information applies.  Because all
VOResource elements are locally defined (in the XML Schema
sense), they do not have an absolute meaning, but rather have a
meaning tied to the thing being described by that element as
represented by the enclosing type.  

Here are three examples that illustrate the semantics communicated by
VOResource entities:

\begin{enumerate}
\item The \xmlel{vr:Curation} type describes the curation of a
       resource.  The \xmlel{curation} element
       describes curation of the specific resource described by the
       enclosing \xmlel{vr:Resource} type and identified by its
       \xmlel{identifier} element. 

  \item The \xmlel{vr:ResourceName} type is a generic reference to
       another resource.  The \xmlel{publisher} element
       gives a reference to the publisher of the specific resource being
       described which may itself be a registered resource described
       elsewhere.  

  \item The \xmlel{title} element gives the title of
       the resource being described the enclosing
       \xmlel{vr:Resource} type and identified by its
       \xmlel{identifier} element.  The
       \xmlel{title} element's type,
       \xmlel{xs:token} (a restriction on
       \xmlel{xsd:string}), has no inherent meaning associated
       with it.   
\end{enumerate}


% TODO: reference  example?
Additional semantics are transmitted through the use of derived types
using the \xmlel{xsi:type} attribute.  In the sample instance document
above, the use of \xmlel{xsi:type="Organisation"} means that the
resource being described is specifically an organisation as defined by
the \xmlel{vr:Organisation} type.  This type provides additional
metadata that are not part of the core resource metadata.  The semantics
associated with the use of \xmlel{xsi:type} is described further in the
next subsection.



\subsubsection{Refined Semantics with Derived Types}
\label{sect:derivedtypes}

When a resource is described with an element explicitly of the type
\xmlel{vr:Resource}, it is being described in the most generic
sense.  The metadata presented in this type, including both free text
values and controlled vocabulary, can give some sense of what
type of resource is being described and what it might be used for.
However, the most useful descriptions of resources will not explicitly
use the \xmlel{vr:Resource} type; rather, they will use types
that are derived from \xmlel{vr:Resource}.  



Defining derived \xmlel{vr:Resource} types accomplishes two
things:
\begin{enumerate}
  \item it sharpens the semantic meaning of the resource description by
       indicating what specific type of resource it is, and
  \item it \emph{may} allow additional metadata not part of the core
       but specific to the that type of resource.
\end{enumerate}



The VOResource schema defines two types derived from
\xmlel{vr:Resource}:  \xmlel{vr:Organisation} and
\xmlel{vr:Service}.   The \xmlel{vr:Organisation} adds
metadata describing the astronomical facilities such as telescopes
that are associated with the organisation it describes.  The
\xmlel{vr:Service} type adds an element called
\xmlel{capability} which describes the service's interface as
well as information regarding its behavior.  



Extensions of the \xmlel{vr:Resource} type is a key way
derivation is used in VOResource to provide refined resource
descriptions.  Two other important parent types in the schema are
\xmlel{vr:Capability} and \xmlel{vr:Interface}; these are
extended to provide more refined descriptions of services (see
sect.~\ref{sect:servicemodel}).  The motivation for extending
these types are the same as for \xmlel{vr:Resource}: to provide
more specific semantic meaning through the derived type's name, and to
provide additional, specialized metadata that is not part of the
parent type.  Note, however, that in general, a derived type need not
alter the content model of its base type.  This allows derived types
to add more specific meaning with out adding any additional metadata.



As described in sect.~\ref{sect:core}, it is intended that derived
\xmlel{vr:Resource}, \xmlel{vr:Capability} and \xmlel{vr:Interface}
types be invoked in instance documents using the \xmlel{xsi:type}
attribute (as illustrated in the sample document above).  This method
illustrates a polymorphism for resource metadata in that any place where
an element of parent type is expected, the derived type may be inserted.
The use of \xmlel{xsi:type} illustrates both what specific type is being
inserted in as well as what it is being inserted in for.  That is, as in
our example, the \emph{resource} being described is an
\emph{organisation}.  



The other mechanism for polymorphism provided by XML Schema is
substitution groups.  Invoking derived \xmlel{vr:Resource} types via
elements in a substitution group is discouraged because it is less
obvious from looking at the instance document that a substitution is
being made.  


\subsubsection{The Service Data Model}
\label{sect:servicemodel}


The \xmlel{vr:Service} type extends the core \xmlel{vr:Resource}
metadata data by adding the \xmlel{capability} element (see
sect.~\ref{sect:serviceelements}).  This element is used to describe a major
functionality of the service, usually accessible through a single
service endpoint URL.  In particular, it is used to describe support for
an IVOA service standard (e.g. Simple Image Access Protocol).  A service
resource record may have multiple child \xmlel{capability} elements,
each describing a different major functionality; however, these
capabilities should be related in an obvious, logical way by virtue of
sharing same core VOResource metadata.  


\begin{admonition}{Note}
Whether multiple related capabilities are grouped together in a
single Service record or are described in separate Service
records is expected to be the choice of the VOResource record
author.  However, it is also expected that resource registry
providers will provide some guidance to authors on best
practices.  This guidance could in part come in the form of a
GUI that naturally encourage or contrains to aggregation of
capabilities in a single record.
\end{admonition}

The \xmlel{capability} element, through its type \xmlel{vr:Capability},
describes the behavior of service capability and how to access it.  The
latter is described by a child \xmlel{interface} element.  As for the
behavior, the base \xmlel{vr:Capability} type only provides a
\xmlel{description} element that can contain human-readable text on what
this capability provides.  More structured behavioral information must
be provided through specialized \xmlel{vr:Capability} extensions.  In
particular, it is expected that a service standard (e.g. Simple Image
Access Protocol) would define an extension of \xmlel{vr:Capability} that
adds additional metadata that can describe the service's behavior in
relation to the standard; for example, the added metadata can describe
limitations of the service implementation or indicate support for
optional features.  The specific \xmlel{vr:Capability} type is invoked
using the \xmlel{xsi:type} mechanism described in
sect.~\ref{sect:namespace}.


Here is an example for assigning a specialized Capability type for
a standard service capability.  In this example, it is assumed that
\xmlel{SimpleImageAccess} extension type is defined in a separate
schema document.
\begin{lstlisting}[language=XML]
<capability xsi:type="sia:SimpleImageAccess"
            standardID="ivo://ivoa.net/std/SIA">
  ...
</capability>
\end{lstlisting}


As the example above suggests, a common way for locating or otherwise
identifying support for a standard service capability is by looking for
the appropriate value in a \xmlel{capability}'s \xmlel{xsi:type}
attribute.  


If the service capability being described does not conform to any
standard or if the standard does not require any specialized
capability metadata for describing an implementation's behavior, then
no \xmlel{vr:Capability} extension is required.  In this case,
the base \xmlel{capability} element is simply used without any
\xmlel{xsi:type} attribute provided.  It is expected that the
metadata provided outside of the \xmlel{capability} element as
well as (optionally) it's \xmlel{description} element is
sufficient for describing what the service does.  



Because each \xmlel{vr:Capability} extension features a different
set of behavioral metadata, introducing a new
\xmlel{vr:Capability} extension can impose a non-trivial cost on
applications that process VOResource records.  Thus, an alternative
way to indicate support for a service standard is provided by the
\xmlel{standardID} attribute which is useful when the standard
does not require any specialized behavioral metadata to be provided.
The value is set to a URI which represents the service standard.  Some
service standards that do extend \xmlel{vr:Capability}
\emph{may} force the value of this attribute to be set to the
appropriate value (see sect.~\ref{sect:derivedtypes});
this allows one to use, when appropriate, the \xmlel{standardID}
as a way to locate support for a standard regardless of whether an
extension type has been defined or not.   



Each \xmlel{capability} element can contain one or more child
\xmlel{interface} elements, each describing how the capability
can be accessed.  The \xmlel{interface} element's type,
\xmlel{vr:Interface}, is abstract; thus, the
\xmlel{interface} element must be accompanied by an
\xmlel{xsi:type} attribute that indicates an
\xmlel{vr:Interface} extension type.  The VOResource schema
defines two \xmlel{vr:Interface} extension types:
\xmlel{vr:WebBrowser}, for describing an interface access via web
browser, and \xmlel{vr:WebService}, for accessing a service
described by a Web Service Description Language (WSDL) document.


When a \xmlel{capability} contains more than one
\xmlel{interface}, each \xmlel{interface} should be
interpreted as an alternative interface for accessing essentially the
same underlying capability.  The interfaces can differ in their
overall type (e.g. \xmlel{vr:WebBrowser},
\xmlel{vr:WebService}) or in the supported input parameters or
output products.  


When a standard capability is being described (i.e. either the
\xmlel{vr:Capability} sub-type is defined by a standard or the
\xmlel{standardID} is provided), then at least one of the
\xmlel{interface} elements should describe an interface required
by the standard.  The \xmlel{role} attribute is used to mark the
standard interfaces (typically with the value "std"; see section XX
for details).  All other interfaces are considered non-standard
alternatives.



Another important way \xmlel{interface}s inside the same
\xmlel{capability} element can be different is in the version of
the service standard the interface supports.  Whenever, an interface
supports a version other than "1.0", the \xmlel{interface}
element must include a \xmlel{version} attribute set to the
version being supported.  Valid values for \xmlel{version} are
defined by the standard.  

Here is an example for describing multiple interfaces for the same
capability. It is assumed that SkyNode extension type is defined in a
separate schema document.

\begin{lstlisting}[language=XML]
<capability xsi:type="sn:SkyNode"
            standardID="ivo://ivoa.net/std/SkyNode">

  <!--  version 1.0 of the standard SkyNode interface --> 
  <interface xsi:type="vr:WebService" role="std" version="1.0">
     <accessURL> http://archive.org/service/skynode </accessURL>
  </interface>

  <!--  version 1.1 of the standard SkyNode interface --> 
  <interface xsi:type="vr:WebService" role="std" version="1.1">
     <accessURL> http://archive.org/service/skynode1.1 </accessURL>
  </interface>

  <!--  a interactive alternative interface, assesible via a browser  --> 
  <interface xsi:type="vr:WebBrowser">
     <accessURL> http://archive.org/skynode.html </accessURL>
  </interface>
  ...
</capability>
\end{lstlisting}

% TODO: discourage this pattern

\subsection{Extending the VOResource Schema}

\label{sect:extending}

A schema made up only of global type definitions provides great
flexibility for extension.  Any global type defined in the VOResource
schema may be used as the base of a derived type defined in another
schema.  The schema containing the derived types must declare its own
namespace URI or default to the null namespace; it must not adopt the
VOResource namespace URI.  The application must then define what
schemas, identified by their namespace URIs, are supported and/or
required.  



A \textbf{VOResource extension} is an XML Schema document whose primary
purpose is to define new types derived from those defined in the
VOResource schema for use in resource descriptions.  It is recommended
that VOResource extensions follow the definition styles used by the core
VOResource.  In particular: 

\begin{itemize}
  \item \emph{Provide semantic definitions of all types and elements within
       the first \xmlel{xsd:documentation} element inside
       the type or element definition.}  Subsequent
       \xmlel{xsd:documentation} elements may provide
       additional comments or discussion.  

  \item \emph{Avoid the use of \xmlel{xsd:choice} elements.}
       VOResource does not use the choice structure because it does
       not map readily into any object-oriented software language
       structure.  Choices are handled instead as multiple derived
       types that can be inserted in place of a parent type.  

  \item \emph{Avoid the use of substitution groups}.  VOResource
       prefers instead the use of \xmlel{xsi:type} which are
       (with a few exceptions) functionally equivalent to substitution
       groups in terms of structure; however, \xmlel{xsi:type}
       serves as an obvious flag in the instance document that a
       substitution has been made. 

  \item \emph{Choose semantically meaningful names for derived
       types.}  When the derived type appears in the pattern
       \verb|<elname xsi:type="derivedType"|,
       choose a \textit{derivedType} name such that the sentence, "a
       \textit{derivedType} is a kind of \textit{elname}" makes natural
       and obvious sense.  For example, "an \textit{Organisation} is a
       kind of \textit{resource}." 

  \item \emph{Follow the VOResource naming conventions}. 
\end{itemize}



There are two types of derivation that are particularly important to
the VOResource data model:  derivation of the \xmlel{vr:Resource}
type, used to define specific types of resources, and the derivation
of service metadata elements.  


\subsubsection{Defining New Resource Types}
\label{sect:definingresourcetypes}


Derivation of \xmlel{vr:Resource} to define new kinds of
resources should be done by extension (i.e. using 
\xmlel{xsd:extension}) rather than restriction.  It is
not required that the derived type change the content model from that
of the \xmlel{vr:Resource} base type; in this case, the purpose
of the derivation is only to sharpen the semantic meaning of the
resource description.  


\subsubsection{Defining New Service Capabilities and Interfaces}
\label{sect:serviceelements}


As described in sect.~\ref{sect:servicemodel}, a service
standard will often define a new \xmlel{vr:Capability} extension
type to allow implementations to describe how they support the
standard.  This definition of the \xmlel{vr:Capability} extension
should be done in a schema document with a namespace identifier that
is dedicated to that standard (hereafter referred to as \emph{the
standard's extension schema}).  The extension type should include
elements representing the applicable Capability metadata described in
section 5.2 of the RM
(e.g. \emph{Service.MaxReturnRecords}, \emph{Service.MaxReturnSize})
but can also include other concepts that are specific to that standard.



The standard's extension schema \emph{may} create a derived
\xmlel{vr:Capability} type that forces the value of the
\xmlel{standardID} attribute to be set to a given URI.  This
should be done by first deriving from \xmlel{vr:Capability} by
\emph{restriction} (i.e. using
\xmlel{xsd:restriction}), keeping all of the parent's
content model except adding to the \xmlel{standardID}'s attribute
definition \xmlel{use="required"} along with the
\xmlel{fixed} modifier set to the desired URI.  Since this
restricted type is not intended for direct use in an instance
document, it should be marked as abstract.  The restricted type should
then be extended to add the specialized capability metadata required
by the standard.  (See the example below.)  



It is not recommended that standard's extension schema attempt to
force the inclusion of a required interface type.  



An extension schema can define new interface types, though not
necessarily in the context of any specific standard service
capability.  The basic \xmlel{vr:Interface} type provides only
\xmlel{accessURL} and \xmlel{securityMethod} as child
elements.  A derived \xmlel{vr:Interface} type must indicate in
the documentation how the \xmlel{accessURL} should be
interpreted and used.  The derived type may also include other added
metadata describing how to use the service (e.g., a description of the
input arguments).  If the interface extension type is expected to be
referenced by a standard service capability, then it is recommended
that the additional metadata be optional unless the metadata is
absolutely required by clients in order to invoke the service.



\begin{admonition}[Note]
It is intended that a set of common generic interface types
would be defined in a separate VOResource extension schema.
At the time of this writing, this schema is called
VODataService.  It currently defines an interface type for
describing traditional GET and POST services.  More specific
interfaces, particularly those associated with standard IVOA
services (like a Registry Service) would derive its specific
interface descriptions from one of the common types as
appropriate.
\end{admonition}


\begin{admonition}[Note]
The Simple Image Access Protocol \citep{2009ivoa.spec.1111H} is an
example of a standard service that defines capability
metadata.  These include "maxRecords" that list the maximum
number of records the SIA implementation can return at a time,
and "MaxImageSize" gives the maximum image size that the
service can return.
\end{admonition}

% TODO: cite some examples for capability derivations


\section{The VOResource Metadata}
\label{sect:metadata}


This section enumerates the types and elements defined in the
VOResource schema and describes their meaning in terms of the
RM.


\subsection{The Base Resource Type}

\label{sect:restype}

A resource, as defined by the RM, is any entity or component of a VO
application that is describable and identifiable by a IVOA Identifier.
A resource is described using VOResource by an element of the type
\xmlel{vr:Resource} or one of its legal extensions.  The schema
definition (below) includes elements that encode the identity, curation,
and general content metadata for a resource (see sections 3.1 through
3.3 of the RM).  The RM states that certain metadata are required in a
minimally compliant resource description; this requirement is enforced
by the VOResource schema definition.  

% GENERATED: !schemadoc VOResource-v1.0.xsd Resource
% /GENERATED


The following sections define the elements that encode the specific
metadata from the RM.  In all cases, the semantic meaning of an element
is defined by the RM metadatum it corresponds to (labeled "\emph{RM
Name}" below).  All rules and advice given in the "Comments" portions in
the RM definition apply.  Any textual differences in the semantic
definitions given below from those given in the RM are intended only for
clarification for the XML encoding context.  


% TODO: That's probably already in the Resource docs
\subsubsection{Identity Metadata}


The identity metadata described in the RM (section
3.1) are represented as top-level children of the
\xmlel{vr:Resource} type.


Two special types, \xmlel{vr:ShortName} and
\xmlel{vr:identifierURI} are defined to support identity
metadata.  The \xmlel{vr:ShortName} definition enforces the
16-character limit on shortNames.  

% GENERATED: !schemadoc VOResource-v1.0.xsd ShortName
% /GENERATED



The \xmlel{vr:IdentifierURI} enforces the URI syntax for IVOA
Identifiers as defined by the IVOA Identifier standard
\citep{std:Identifiers}.

% GENERATED: !schemadoc VOResource-v1.0.xsd IdentifierURI
% /GENERATED



Two additional types which are not used within the
\xmlel{vr:Resource} type but are available to support the two
components of an IVOA Identifier,
\xmlel{vr:AuthorityID} and \xmlel{vr:ResourceKey}.  


% GENERATED: !schemadoc VOResource-v1.0.xsd AuthorityID
% /GENERATED

% GENERATED: !schemadoc VOResource-v1.0.xsd ResourceKey
% /GENERATED



\subsubsection{Curation Metadata}


The curation metadata described in the RM (section
3.2) are bundled together into the \xmlel{vr:Resource} child element,
\xmlel{curation}.  Its content is defined by the
\xmlel{vr:Curation} complex type.



% GENERATED: !schemadoc VOResource-v1.0.xsd Curation
% /GENERATED

Several of the curation elements (most importantly,
\xmlel{publisher}) make use of the
\xmlel{vr:ResourceName} type.  This type is provides a means of
refering to another resource both by name and by its IVOA
identifier.  Not all resources refered to using this type will
necessarily be registered and, therefore, will have an identifier;
thus, the identifier (which is encoded as an attribute) is optional. 


% GENERATED: !schemadoc VOResource-v1.0.xsd ResourceName
% /GENERATED


The \xmlel{creator} element is defined by the \xmlel{vr:Creator} complex
type which bundles together the RM metadata \emph{Creator} and
\emph{Creator.Logo}.



% GENERATED: !schemadoc VOResource-v1.0.xsd Creator
% /GENERATED


The \xmlel{Date} element's type, \xmlel{vr:Date}, is an extension of the
\xmlel{UTCDateTime} type that adds an
optional attribute called \xmlel{role}.  


% GENERATED: !schemadoc VOResource-v1.0.xsd Date
% /GENERATED


It is important to note that the \xmlel{date} element describes the
resource itself, not the resource record that describes it.  Dates
describing the resource record are covered by \xmlel{vr:Resource}
attributes \xmlel{created} and \xmlel{updated}



The \xmlel{contact} element is defined by the
\xmlel{vr:Contact} type which bundles together several component
pieces of information, including the RM metadata \emph{Contact.Name}
and \emph{Contact.Email}.  



% GENERATED: !schemadoc VOResource-v1.0.xsd Contact
% /GENERATED



\subsubsection{General Content Metadata}


The general content metadata described in the RM.
(section 3.3) are bundled together into the \xmlel{vr:Resource}
child element, \xmlel{content}.  Its content is
defined by the \xmlel{vr:Content} complex type.


% GENERATED: !schemadoc VOResource-v1.0.xsd Content
% /GENERATED



The \xmlel{source} element's type,
\xmlel{vr:Source}, is an extension of the
\xmlel{xs:token} type that adds an optional attribute called
\xmlel{format}.  


% GENERATED: !schemadoc VOResource-v1.0.xsd Source
% /GENERATED


The \xmlel{relationship} is defined by the
\xmlel{vr:Relationship} complex type which bundles together the
RM metadata \emph{Relationship} and
\emph{RelationshipID}.  


% GENERATED: !schemadoc VOResource-v1.0.xsd Relationship
% /GENERATED


It is important to note that the \xmlel{relationshipType}
controlled vocabulary is not enforced by the schema itself.  This
allows a future version of this specification to define additional
terms without requiring a change in the XML Schema document.


\subsubsection{Resource Record Quality with validationLevel}



The RM's \emph{ResourceValidationLevel} is encoded in the VOResource
schema with the \xmlel{validationLevel} element, which can appear in
multiple places within a \xmlel{vr:Resource} type or sub-type.  It may
appear one or more times as the first children of a \xmlel{vr:Resource}
type and/or, if the resource is a \xmlel{vr:Service} type or sub-type,
one or more times as the first children of any \xmlel{capability}
element.  

The \xmlel{validationLevel} element requires an attribute called
\xmlel{validatedBy} which takes an IVOA ID as a value.  This ID
must refer to a registered organisation or registry that assigned the
numerical value.  This element can appear multiple times, each with
a different \xmlel{validatedBy} value, to reflect the code
assigned by different organisations. 


% GENERATED: !schemadoc VOResource-v1.0.xsd Validation
% /GENERATED

\subsection{Resource Type Extensions:  Organisation and Service}

The VOResource schema defines two extensions of the base
\xmlel{vr:Resource} type for describing two specific types of
resources:  \xmlel{vr:Organisation} and \xmlel{vr:Service}.  In
addition to providing more refined semantic meaning over
\xmlel{vr:Resource}, they add additional metadata for the
describing the resource which don't necessarily apply in the generic
case. 



\subsubsection{The Organisation Resource Type}


The Organisation resource type is used to describe an organisation in
the sense defined by the RM:


\begin{quotation}
An organisation is a specific type of resource that brings people
together to pursue participation in VO applications.  Organisations
can be hierarchical and range greatly in size and scope.  At a high
level, an organisation could be a university, observatory, or
government agency.  At a finer level, it could be a specific
scientific project space mission, or individual researcher.  
\end{quotation}


The Organisation type extends the Resource type by adding two additional
elements to the core set of metadata, \xmlel{facility} and
\xmlel{instrument}:


% GENERATED: !schemadoc VOResource-v1.0.xsd Organisation
% /GENERATED

The main role of an organisation in the VO (that is, the main reason
for describing organisations in a registery) is as a provider or
publishier of other resources.  In particular, an organisation
description in a registry declares the association of an IVOA
identifier with the organisation.  The
organisation can then be referred to in other resource descriptions.
For example, an organisation identifier will appear as the publisher
identifier of service resource (as illustrated in the opening
example in sect.~\ref{sect:model}.


\subsubsection{The Service Resource Type}


The Service resource type is used to describe a service--a resource
that actually does something--in the sense defined by the
RM:

\begin{quotation}
A service is any VO resource that can be invoked by the user to
perform some action on their behalf.  
\end{quotation}


The general data model is described in sect.~\ref{sect:servicemodel}.
The Service type extends the Resource type by adding two elements:
\xmlel{rights} which indicates who may access it, and
\xmlel{capability} which describes how the service behaves and how it is
invoked.


% GENERATED: !schemadoc VOResource-v1.0.xsd Service
% /GENERATED

As described in sect.~\ref{sect:servicemodel}, multiple
\xmlel{capability} elements may appear, each describing a
different capability of the service.  


% GENERATED: !schemadoc VOResource-v1.0.xsd Capability
% /GENERATED


The \xmlel{capability} element is sufficient for describing a
\emph{custom service capability}--i.e., a service that is
particular to one provider and does not conform to a specific standard 
(be it recognized by the IVOA or some other sub-community).  However,
service standards will often create a \xmlel{vr:Capability}
extension that adds additional metadata that are specific that that
are specific to the behavior of that particular type of service.  



\begin{admonition}{Note}
The RM defines three metadata that may be
important for several standard query services:
\emph{Service.MaxSearchRadius},
\emph{Service.MaxReturnRecords}, and
\emph{Service.MaxReturnSize}.  These are examples of
service-specific metadata that should be encoded as child
elements in a type derived from \xmlel{vr:Capability}.  
\end{admonition}


The \xmlel{interface} element is of the complex type 
\xmlel{vr:Interface}.


% GENERATED: !schemadoc VOResource-v1.0.xsd Interface
% /GENERATED


As mentioned in the table above, exactly how a client uses the value
of the \xmlel{accessURL} element depends on the specific
type derived from \xmlel{vr:Interface}.  Extension schemas that
define non-abstract types derived from \xmlel{vr:Interface } MUST
provide documentation that explains the exact use of the
\xmlel{accessURL}; this documentation should follow the
documention conventions described in sect.~\ref{sect:core}.  If multiple
\xmlel{accessURL} may be provide; however, each URL should
point to a functionally identical or "mirror" installation of the same
service and administered by the same publisher listed above.  An
\xmlel{accessURL} must not point to an installation
that is outside the administrative control of the service's listed
publisher; such a mirror should be describe in a separate resource
record.  



As an additional aid to software agents that will attempt to interpret
its URL, the \xmlel{vr:AccessURL} includes an optional element,
\xmlel{use} (pronounced and interpreted as in the noun form of
the word use) which takes a controlled vocabulary:


% GENERATED: !schemadoc VOResource-v1.0.xsd AccessURL
% /GENERATED


The \xmlel{vr:SecurityMethod} type is
defined as a complex type but with empty content:


% GENERATED: !schemadoc VOResource-v1.0.xsd SecurityMethod
% /GENERATED

While this simple element (when the \xmlel{standardID} attribute
is provided) may on its own be sufficient to describe the security
mechanism used, it is expected that some future
VOResource extension schema will define
additional types derived from \xmlel{vr:SecurityMethod}.  If such
a sub-type is available, it may be employed at
\xmlel{securityMethod} location within a
\xmlel{vr:Interface}-typed element, in which case, it should be
invoked via a \xmlel{xsi:type} attribute to the
\xmlel{securityMethod} element.  


\xmlel{vr:WebBrowser} is one of the two \xmlel{vr:Interface}
sub-types defined by the VOResource schema.  This type indicates that
the service is intended to be accessed interactively by a user through
a web browser.  The \xmlel{accessURL}, then, reprensents
the URL of a web page containing one or more forms used to invoke the
service. 


% GENERATED: !schemadoc VOResource-v1.0.xsd WebBrowser
% /GENERATED


As can be seen in the schema definition above, the
\xmlel{vr:WebBrowser} type does not define any additional
interface metadata (though other \xmlel{vr:Interface} derivations
may).  Thus, this type is provide purely for its semantic meaning.  



\xmlel{vr:WebService} is the second \xmlel{vr:Interface}
sub-type available from the VOResource schema:

% GENERATED: !schemadoc VOResource-v1.0.xsd WebService
% /GENERATED


\begin{admonition}{Note}
It is intended that other \xmlel{vr:Interface} types,
along with additional resource types derived from
\xmlel{vr:Service}, will be defined in at least one other
IVOA standard extension that is specifically geared to
services.  
\end{admonition}

\appendix

\section{Change History}

\subsection{Changes from REC-1.03}

\begin{itemize}
\item removed SOAP/WSDL example and a bit of the accompanying language.
\item Ported document source to \ivoatex.
\item Removed example for deriving a SIA capability (this is now
in the document repository)
\end{itemize}

\subsection{Changes from v1.02}
\begin{itemize}
  \item converted to Recommendation
\end{itemize}

\subsection{Changes from v1.01:}
\begin{itemize}
  \item \xmlel{status} attribute is now required.
  \item added this Change History appendix.
\end{itemize}

\subsection{Changes from v1.0}
\begin{itemize}
  \item dropped \xmlel{PaddedString}, \xmlel{PaddedURI} and replaced
       with \xmlel{xs:token}.
  \item made \xmlel{Validation}'s \xmlel{validatedBy} attribute
       required.
  \item reference citation correction for SOAP, WSDL
\end{itemize}



\bibliography{ivoatex/ivoabib,ivoatex/docrepo}


\end{document}
